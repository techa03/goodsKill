= å‰è¨€

image:https://img.shields.io/badge/license-MIT-blue.svg[License,link=LICENSE]
image:https://github.com/techa03/goodsKill/actions/workflows/maven.yml/badge.svg?branch=master[Java CI with Maven,link=https://github.com/techa03/goodsKill/actions/workflows/maven.yml]
image:https://codecov.io/gh/techa03/goodsKill/branch/master/graph/badge.svg[codecov,link=https://codecov.io/gh/techa03/goodsKill]
image:https://sonarcloud.io/api/project_badges/measure?project=techa03_goodsKill&metric=alert_status[Quality Gate Status,link=https://sonarcloud.io/dashboard?id=techa03_goodsKill]
image:https://github.com/techa03/goodsKill/actions/workflows/codeql-analysis.yml/badge.svg?branch=master[CodeQL,link=https://github.com/techa03/goodsKill/actions/workflows/codeql-analysis.yml]

é¡¹ç›®å‘½åä¸º *goodsKill* ä¸€æ–¹é¢æœ‰å•†å“ç§’æ€çš„æ„æ€(å¥½åƒæœ‰ç‚¹chinglishçš„å‘³é“)ï¼Œå¦å¤–ä¹Ÿå¯ç†è§£ä¸º *good skill*ï¼Œæœ¬é¡¹ç›®å°±æ˜¯å¸Œæœ›æ­å»ºä¸€å¥—å®Œæ•´çš„é¡¹ç›®æ¡†æ¶ï¼ŒæŠŠä¸€äº›å¥½çš„æŠ€æœ¯å’Œå¼€å‘æŠ€å·§æ•´åˆè¿›æ¥ï¼ˆåå‘äºåç«¯æŠ€æœ¯ï¼‰ï¼Œæ–¹ä¾¿å­¦ä¹ å’ŒæŸ¥é˜…ã€‚


æœ¬é¡¹ç›®ä¸ºæ…•è¯¾ç½‘ä»¿è´­ç‰©ç§’æ€é¡¹ç›®ï¼ŒåŠŸèƒ½ä¸Šæ•´ä½“åˆ†ä¸ºç”¨æˆ·æ³¨å†Œç™»å½•ã€ç§’æ€å•†å“ç®¡ç†æ¨¡å—ã€‚ä½¿ç”¨Shiroå®Œæˆç™»å½•éªŒè¯æˆæƒä»¥åŠç”¨æˆ·æƒé™éªŒè¯ï¼ˆæƒé™è®¾è®¡ä½¿ç”¨RBACæ¨¡å‹ï¼‰ï¼Œæ”¯æŒOAuth2.0ç¬¬ä¸‰æ–¹æˆæƒç™»å½•ï¼ˆç›®å‰å¯é€šè¿‡Giteeï¼ŒGithubè¿›è¡Œæˆæƒï¼‰ã€‚ æŠ€æœ¯ä¸Šæ•´ä½“é‡‡ç”¨SpringMVC+RESTFULé£æ ¼ï¼ŒMybatisæŒä¹…å±‚æ¡†æ¶ï¼Œé‡‡ç”¨Dubbo3.x{empty}footnote:[ç”±äºSpringCloudAlibabaå®˜æ–¹æš‚æœªæ”¯æŒDubbo 3.xï¼Œæœ¬é¡¹ç›®é‡‡ç”¨dubbo-spring-boot-starteré›†æˆï¼Œä½¿ç”¨zookeeperæ³¨å†Œä¸­å¿ƒ]ä»¥åŠFeignå®ç°åˆ†å¸ƒå¼æœåŠ¡è°ƒç”¨ï¼ŒæœåŠ¡æ³¨å†Œå‘ç°ä»¥åŠé…ç½®ä¸­å¿ƒä½¿ç”¨Nacosã€‚

æœ¬é¡¹ç›®åœ¨åŸåŸºç¡€ä¸Šæ‰©å±•äº†éƒ¨åˆ†åŠŸèƒ½ï¼Œä¾‹å¦‚æ”¯æŒæ•°æ®åº“åˆ†åº“åˆ†è¡¨ã€åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œå¹¶æä¾›åŸºæœ¬çš„ç§’æ€è§£å†³æ–¹æ¡ˆï¼ˆé€šè¿‡æ¨¡æ‹Ÿæ¥å£å®ç°ï¼‰ã€‚

* é›†æˆSpringCloudAlibaba Sentinelé™æµç»„ä»¶ï¼Œå¯ä»¥é’ˆå¯¹Httpè¯·æ±‚é™æµ

* é›†æˆæœåŠ¡ç½‘å…³ï¼Œé‡‡ç”¨Spring Cloud Gatewayç½‘å…³ç»„ä»¶ï¼Œæ”¯æŒåŠ¨æ€è·¯ç”±åˆ·æ–°

== ğŸ’åˆ†æ”¯ä»‹ç»

``dev_gradle``åˆ†æ”¯ä¸ºä½¿ç”¨gradleæ„å»ºå·¥å…·ç®¡ç†é¡¹ç›®ä¾èµ–ï¼ˆå·²åœæ›´ï¼‰ï¼Œ``dev_maven``åˆ†æ”¯å¯¹åº”mavenæ„å»ºå·¥å…·ï¼ˆSpring Frameworkç‰ˆæœ¬4.xï¼Œå·²åœæ›´ï¼‰ï¼Œ``master``åˆ†æ”¯åŸºäºæœ€æ–°Spring Cloudä½“ç³»æ„å»ºã€‚æœ¬é¡¹ç›®åŠŸèƒ½ç›®å‰æ¯”è¾ƒç®€é™‹ä¸”æœ‰å¾ˆå¤šä¸å®Œå–„çš„åœ°æ–¹ï¼ŒçœŸå®çš„ç§’æ€åœºæ™¯è¿œæ¯”æœ¬é¡¹ç›®ä¸­çš„å®ç°æ–¹å¼å¤æ‚ï¼Œæœ¬é¡¹ç›®çœç•¥äº†çœŸå®åœºæ™¯ä¸­çš„éƒ¨åˆ†æŠ€æœ¯å®ç°ç»†èŠ‚ï¼Œç›®å‰ä»…ä½œå­¦ä¹ å‚è€ƒä¹‹ç”¨ï¼Œå¦‚æœè§‰å¾—æœ¬é¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©çš„è¯·å¤šå¤šstaræ”¯æŒä¸€ä¸‹ğŸ‘~~~~ã€‚
____

é™„ï¼šç äº‘é¡¹ç›®é“¾æ¥ `https://gitee.com/techa/goodsKill`,cloneé€Ÿåº¦æ…¢çš„ç”¨ç äº‘ä»“åº“æ‹‰å§ï¼Œä¸å®šæœŸåŒæ­¥åˆ°ç äº‘~

____

== âœ¨æŠ€æœ¯é€‰å‹

=== ğŸ“Œåç«¯æŠ€æœ¯:

|===
|æŠ€æœ¯ |åç§° |å®˜ç½‘

|Spring Boot |æ¡†æ¶ |https://spring.io/projects/spring-boot
|MyBatis-Plus |MyBatiså¢å¼ºå·¥å…· |https://mp.baomidou.com/
|Hikari |æ•°æ®åº“è¿æ¥æ±  |https://github.com/brettwooldridge/HikariCP
|ZooKeeper |åˆ†å¸ƒå¼åè°ƒæœåŠ¡ |http://zookeeper.apache.org/
|Redis |åˆ†å¸ƒå¼ç¼“å­˜æ•°æ®åº“ |https://redis.io/
|Kafka |æ¶ˆæ¯é˜Ÿåˆ— |http://kafka.apache.org/
|RabbitMQ |æ¶ˆæ¯é˜Ÿåˆ— |https://www.rabbitmq.com/
|Logback |æ—¥å¿—ç»„ä»¶ |https://logback.qos.ch/
|Maven |é¡¹ç›®æ„å»ºç®¡ç† |http://maven.apache.org/
|Swagger3 |é¡¹ç›®APIæ–‡æ¡£ç”ŸæˆåŠæµ‹è¯•å·¥å…· |http://swagger.io/
|Mockito |mockç±»ç”Ÿæˆæµ‹è¯•å·¥å…· |https://site.mockito.org/
|Jacoco |æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Šæ’ä»¶ |http://www.eclemma.org/jacoco/
|Shiro |ç”¨æˆ·æƒé™å®‰å…¨ç®¡ç†æ¡†æ¶ |https://shiro.apache.org/
|MongoDB |Mongoæ•°æ®åº“ |https://www.mongodb.com/
|MySQL |MySQLæ•°æ®åº“ |https://www.mysql.com/
|Reactor |ååº”å¼å¼‚æ­¥ç¼–ç¨‹ |https://projectreactor.io/
|Spring Session |Springä¼šè¯ç®¡ç† |https://spring.io/projects/spring-session
|Elasticsearch |å…¨æ–‡æœç´¢å¼•æ“ |https://www.elastic.co
|H2 |H2æ•°æ®åº“ |http://www.h2database.com/html/main.html
|Sharding-JDBC |åˆ†åº“åˆ†è¡¨ç»„ä»¶ |https://shardingsphere.apache.org
|Spring Cloud Alibaba |Cloud Alibabaç»„ä»¶ |https://github.com/alibaba/spring-cloud-alibaba
|Apache Dubbo | RPCæœåŠ¡è¿œç¨‹è°ƒç”¨æ¡†æ¶ |https://github.com/apache/dubbo
|Spring Cloud Gateway |ç½‘å…³ç»„ä»¶ |https://spring.io/projects/spring-cloud-gateway
|Kotlin |Kotlin |https://kotlinlang.org/
|Seata |åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆ |http://seata.io/zh-cn/index.html
|Spring Security OAuth2.0 |OAuth2.0æˆæƒç»„ä»¶ |https://spring.io/projects/spring-security-oauth
|Canal |åŸºäºMySQLæ•°æ®åº“çš„å¢é‡æ—¥å¿—è§£æå·¥å…· |https://github.com/alibaba/canal
|MinIO |ä¸€æ¬¾é«˜æ€§èƒ½ã€åˆ†å¸ƒå¼çš„å¯¹è±¡å­˜å‚¨ç³»ç»Ÿ |https://min.io/
|===

=== ğŸ“Œå‰ç«¯æŠ€æœ¯:
|===
|æŠ€æœ¯ |åç§° |å®˜ç½‘

|JQuery |å‡½å¼åº“ |http://jquery.com/
|Bootstrap |å‰ç«¯æ¡†æ¶ |http://getbootstrap.com/
|LayUI |å‰ç«¯UIæ¡†æ¶ |https://github.com/sentsin/layui
|===

== ğŸ“é¡¹ç›®æ¨¡å—ä»‹ç»

----
goodsKill
|--goodskill-admin                          ||SpringBoot Adminç›‘æ§æœåŠ¡ç«¯ï¼Œæ”¯æŒSpring Cloudå¾®æœåŠ¡å‘ç°
|--goodskill-canal                          ||ç”¨äºå®ŒæˆMySQLæ•°æ®åº“binlogæ”¶é›†çš„canalå®¢æˆ·ç«¯ç¨‹åº
|--goodskill-chat-provider                  ||ä¸€ä¸ªåŸºäºnettyå®ç°çš„ç®€æ˜“èŠå¤©ç¨‹åº
|--goodskill-gateway                        ||å¾®æœåŠ¡ç½‘å…³ï¼Œæ”¯æŒåŠ¨æ€è·¯ç”±åŠ è½½
|--goodskill-es-provider                    ||elasticsearchæœç´¢æœåŠ¡æä¾›è€…ï¼Œæä¾›å•†å“åç§°æ£€ç´¢åŠŸèƒ½
|   |--goodskill-es-service
|--goodskill-mongo-provider                 ||mongoå­˜å‚¨æœåŠ¡æä¾›è€…
|   |--goodskill-mongo-service
|--goodskill-spring-boot-provider           ||è®¢å•ã€ç”¨æˆ·ã€ç™»å½•ã€å•†å“ç®¡ç†æœåŠ¡æä¾›è€…ï¼ˆå¾…æ‹†åˆ†ï¼‰
|   |--goodskill-api                        ||æä¾›æœåŠ¡APIæ¥å£
|   |--goodskill-mp-dao                     ||æ•°æ®åº“è®¿é—®
|   |--goodskill-entry                      ||å®ä½“ç±»
|   |--goodskill-generator                  ||é¡¹ç›®ä»£ç ç”Ÿæˆ
|   |--goodskill-service                    ||æœåŠ¡APIæ¥å£å®ç°
|--goodskill-spring-boot-starter            ||é¡¹ç›®é…ç½®è‡ªåŠ¨è£…é…
|--goodskill-web                            ||æä¾›é¡µé¢å®¢æˆ·ç«¯è®¿é—®ï¼Œcontrollerå±‚åœ¨è¿™ä¸€æ¨¡å—
|--goodskill-job                            ||elastic-jobå®šæ—¶ä»»åŠ¡
|--goodskill-seata                          ||é›†æˆnacos+dubbo+shardingjdbc+seataçš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆç¤ºä¾‹
|--goodskill-oauth2                         ||oauth2.0è‡ªå®šä¹‰æ¨¡å—
    |--oauth2-auth-server                   ||oauth2.0ç™»å½•æˆæƒæœåŠ¡ç«¯ï¼Œè‡ªå®šä¹‰çš„æˆæƒç™»å½•æœåŠ¡
    |--oauth2-resource-server               ||oauth2.0èµ„æºæœåŠ¡ç«¯ï¼Œè‡ªå®šä¹‰çš„æˆæƒç™»å½•æœåŠ¡
|--goodskill-swagger-docs                   ||swagger3.0æ–‡æ¡£èšåˆè®¿é—®æœåŠ¡
----

== ğŸ”¥ğŸ”¥ç§’æ€æ–¹æ¡ˆ

ç›®å‰å®ç°äº†å‡ ç§ç§’æ€æ–¹æ¡ˆï¼Œé€šè¿‡``SeckillMockController``æä¾›æµ‹è¯•æ¥å£

Swaggerä¸»é¡µæµ‹è¯•åœ°å€: `http://www.goodskill.com:8080/goodskill/web/swagger-ui/index.html`

èšåˆSwaggeræ–‡æ¡£åœ°å€: `http://localhost:18060/doc.html#/home`ï¼ˆéœ€è¦å¼€å¯SwaggerDocsApplicationæœåŠ¡ï¼‰

Spring Boot Adminåº”ç”¨ç›‘æ§åœ°å€: `http://www.goodskill.com:19031`, ç™»å½•ç”¨æˆ·åå¯†ç ï¼šuser/123456

KafkaçŠ¶æ€ç›‘æ§é¡µé¢åœ°å€: `http://localhost:9001`

Zipkiné“¾è·¯è·Ÿè¸ªé¡µé¢åœ°å€: `http://localhost:9411/zipkin/`

* åœºæ™¯ä¸€ï¼šSychronizedåŒæ­¥é”å®ç°
* åœºæ™¯äºŒï¼šRedissonåˆ†å¸ƒå¼é”å®ç°
* åœºæ™¯ä¸‰ï¼šActiveMQå®ç°(å·²åºŸå¼ƒ)
* åœºæ™¯å››ï¼šKafkaæ¶ˆæ¯é˜Ÿåˆ—å®ç°
* åœºæ™¯äº”ï¼šæ•°æ®åº“åŸå­æ€§æ›´æ–°
* åœºæ™¯å…­ï¼šå®æ—¶ç­‰å¾…ç§’æ€å¤„ç†ç»“æœ(å·²åºŸå¼ƒ)
* åœºæ™¯ä¸ƒï¼šZooKeeperåˆ†å¸ƒå¼é”
* åœºæ™¯å…«ï¼šä½¿ç”¨Redisè¿›è¡Œç§’æ€å•†å“å‡åº“å­˜æ“ä½œï¼Œç§’æ€ç»“æŸåå¼‚æ­¥å‘é€MQï¼Œä½¿ç”¨MongoDBå®Œæˆæ•°æ®è½åœ°
* åœºæ™¯ä¹ï¼šSpring Cloud Streamå®ç°
* åœºæ™¯åï¼šSentinelé™æµ+æ•°æ®åº“åŸå­æ€§æ›´æ–°ï¼ˆéœ€æ­é…sentinelæ§åˆ¶å°é…ç½®èµ„æºå``limit``çš„æµæ§è§„åˆ™ï¼‰
* åœºæ™¯åä¸€ï¼šæ•°æ®åº“åŸå­æ€§æ›´æ–° + Canalæ•°æ®åº“binlogæ—¥å¿—ç›‘å¬ç§’æ€ç»“æœ

.å¯åœ¨webæ§å°æŸ¥çœ‹ç§’æ€ç»“æœï¼Œæ‰“å°ä¿¡æ¯ç±»ä¼¼ï¼š
[%collapsible]
====
[source,text]
----
2021-04-14 21:58:59.857  INFO [goodskill-web,df43cc8f59291c48,df43cc8f59291c48] 15808 --- [           main] o.s.w.controller.SeckillMockController   : ç§’æ€åœºæ™¯äºŒ(redisåˆ†å¸ƒå¼é”å®ç°)å¼€å§‹æ—¶é—´ï¼šWed Apr 14 21:58:59 CST 2021,ç§’æ€idï¼š1000
2021-04-14 21:59:00.094  INFO [goodskill-web,144aa7910cca9520,2821cb8d62c5a908] 15808 --- [AClOSzbugzYng-1] o.s.w.s.c.SeckillMockResponseListener    : ç§’æ€æ´»åŠ¨ç»“æŸï¼Œç§’æ€åœºæ™¯äºŒ(redisåˆ†å¸ƒå¼é”å®ç°)æ—¶é—´ï¼šWed Apr 14 21:59:00 CST 2021,ç§’æ€idï¼š1000
2021-04-14 21:59:00.101  INFO [goodskill-web,144aa7910cca9520,2821cb8d62c5a908] 15808 --- [AClOSzbugzYng-1] o.s.w.s.c.SeckillMockResponseListener    : æœ€ç»ˆæˆåŠŸäº¤æ˜“ç¬”æ•°ç»Ÿè®¡ä¸­ã€‚ã€‚ã€‚
2021-04-14 21:59:01.616  INFO [goodskill-web,144aa7910cca9520,2821cb8d62c5a908] 15808 --- [AClOSzbugzYng-1] o.s.w.s.c.SeckillMockResponseListener    : æœ€ç»ˆæˆåŠŸäº¤æ˜“ç¬”æ•°ç»Ÿè®¡ä¸­ã€‚ã€‚ã€‚
2021-04-14 21:59:03.129  INFO [goodskill-web,144aa7910cca9520,2821cb8d62c5a908] 15808 --- [AClOSzbugzYng-1] o.s.w.s.c.SeckillMockResponseListener    : æœ€ç»ˆæˆåŠŸäº¤æ˜“ç¬”æ•°ï¼š10
2021-04-14 21:59:03.130  INFO [goodskill-web,144aa7910cca9520,2821cb8d62c5a908] 15808 --- [AClOSzbugzYng-1] o.s.w.s.c.SeckillMockResponseListener    : å†å²ä»»åŠ¡è€—æ—¶ç»Ÿè®¡ï¼šStopWatch '': running time = 36159894800 ns
---------------------------------------------
ns         %     Task name
---------------------------------------------
4492195700  012%  ç§’æ€åœºæ™¯å››(kafkaæ¶ˆæ¯é˜Ÿåˆ—å®ç°)
3164155900  009%  ç§’æ€åœºæ™¯å…«(ç§’æ€å•†å“å­˜æ”¾rediså‡åº“å­˜ï¼Œå¼‚æ­¥å‘é€ç§’æ€æˆåŠŸMQï¼ŒmongoDbæ•°æ®è½åœ°)
6219218300  017%  ç§’æ€åœºæ™¯å(Sentinelé™æµ+æ•°æ®åº“åŸå­æ€§æ›´æ–°)
9189080600  025%  ç§’æ€åœºæ™¯ä¸ƒ(zookeeperåˆ†å¸ƒå¼é”)
3135926500  009%  ç§’æ€åœºæ™¯äº”(æ•°æ®åº“åŸå­æ€§æ›´æ–°update set num = num -1)
3342791800  009%  ç§’æ€åœºæ™¯ä¹(åŸºäºspringcloud stream rabbitmq)
3343433700  009%  ç§’æ€åœºæ™¯ä¸€(sychronizedåŒæ­¥é”å®ç°)
3273092300  009%  ç§’æ€åœºæ™¯äºŒ(redisåˆ†å¸ƒå¼é”å®ç°)
----
====

== ğŸ§°å¼€å‘ç¯å¢ƒç‰ˆæœ¬è¯´æ˜

* JDK: OpenJDK11
* Sharding-JDBC: 4.1.1
* SpringCloud: 2021.x.x
* SpringBoot: 2.7.x
* SpringCloudAlibaba: 2021.x
* Apache Dubbo: 3.x
* Kotlin: 1.6.x
* ä½¿ç”¨çš„Dockeré•œåƒ
+
|===
|é•œåƒ |ç‰ˆæœ¬ |ç«¯å£ |ç”¨æˆ·åå¯†ç 

|Nacos |2.0.3 |8848 |nacos:nacos
|Redis |latest |6379 |å¯†ç :123456
|Kafka |3.1.1 |9092 |æ— 
|KafkaManager |latest |9001:9000 |æ— 
|Mongo |4.6.0 |27017 |æ— 
|MySQL |8.0.29 |3306 |root:Password123
|Zookeeper |3.6.2 |2181 |æ— 
|Elasticsearch |7.17.3 |9200 9300 |æ— 
|Kibana |7.17.3 |5601 |æ— 
|RabbitMQ |latest |5672 15672 |æ— 
|Zipkin |latest |9411 |æ— 
|MinIO |latest |19000:9000 19001:9001| root:password
|===

== ğŸ¯å¿«é€Ÿå¼€å§‹

* é¡¹ç›®æ ¹ç›®å½•``goodsKill``ä¸­æ‰§è¡Œ
+
----
  mvn clean install
  æˆ–
  #è·³è¿‡å•å…ƒæµ‹è¯•
  mvn clean install -DskipTests
----

* é»˜è®¤ç«¯å£å¯åŠ¨nacosã€redisã€mysqlã€rabbitmqã€kafkaã€zookeeperï¼Œæˆ–è€…ä½¿ç”¨docker-compose{empty}footnote:[éœ€è¦å®‰è£…docker-desktop https://www.docker.com/products/docker-desktop/]å‘½ä»¤ï¼š
+
[source,bash]
----
  docker-compose -f goodskill-simple.yml up -d
----

* è¿›å…¥``goodskill-web/src/main/sql``ç›®å½•ï¼Œæ‰¾åˆ°``seckill.sql``æ–‡ä»¶ï¼Œåœ¨æœ¬åœ°mysqlæ•°æ®åº“ä¸­å»ºç«‹``seckill``ä»“åº“å¹¶æ‰§è¡Œå®Œæˆæ•°æ®åˆå§‹åŒ–æ“ä½œ
+

:warning-caption: âš ï¸ï¸

[WARNING]
docker-composeå¯åŠ¨MySQLé•œåƒæ—¶ä¼šè‡ªåŠ¨æ‰§è¡Œåˆå§‹åŒ–è„šæœ¬ï¼Œå¦‚å·²æ‰§è¡Œè¿‡ä¸Šä¸€æ­¥æœ¬æ­¥éª¤å¯è·³è¿‡

* é…ç½®host
[source,text]
+

----
 127.0.0.1       kafka
 127.0.0.1       nacos
 127.0.0.1       redis
 127.0.0.1       mysql
 127.0.0.1       zookeeper
 127.0.0.1       mongo
 127.0.0.1       elasticsearch
 127.0.0.1       rabbitmq
 127.0.0.1       zipkin
 127.0.0.1       logstash
 ##å¦‚æœç½‘å…³æœåŠ¡éƒ¨ç½²åœ¨è¿œç¨‹æœºå™¨ï¼Œæ­¤å¤„æ”¹ä¸ºç›¸åº”çš„è¿œç¨‹æœºå™¨ip
 127.0.0.1       www.goodskill.com
----

* mainæ–¹æ³•è¿è¡Œ``MongoReactiveApplication``ç±»(mongoæœåŠ¡)

* mainæ–¹æ³•è¿è¡Œ``GoodsKillServiceApplication``ç±»(è®¢å•ã€ç”¨æˆ·ã€ç™»å½•ã€å•†å“ç®¡ç†æœåŠ¡æä¾›è€…)

* mainæ–¹æ³•è¿è¡Œ``SampleWebJspApplication``ç±»(webæœåŠ¡)

* å¯åŠ¨å®Œæˆåè®¿é—®ç™»å½•é¡µé¢ `http://www.goodskill.com:8080/goodskill/web/login`ï¼Œé»˜è®¤ç®¡ç†å‘˜è´¦å·admin123ï¼Œå¯†ç ï¼šaa123456

* å¯åŠ¨å®Œæˆåå‘é€ä¸€ä¸ªç§’æ€æ¨¡æ‹Ÿè¯·æ±‚ï¼š
ç§’æ€æ´»åŠ¨id 1000ï¼Œå•†å“æ•°é‡10ï¼Œæ‰§è¡Œ20æ¬¡è´­ä¹°æ“ä½œï¼Œä½¿ç”¨sychronizedåŒæ­¥é”æ‰§è¡Œï¼Œä¾‹å¦‚ï¼š
+
.ä½¿ç”¨sychronizedåŒæ­¥é”æ‰§è¡Œ
====
[source,bash]
curl -X POST "http://www.goodskill.com:8080/goodskill/web/sychronized" \
-H "accept: */*" -H "Content-Type: application/json" -d \
"{ \"requestCount\": 20, \"seckillCount\": 10, \"seckillId\": 1000}"
====
+
.ä½¿ç”¨Redissonåˆ†å¸ƒå¼é”æ‰§è¡Œ
====
[source,bash]
curl -X POST "http://www.goodskill.com:8080/goodskill/web/redisson" \
-H "accept: */*" -H "Content-Type: application/json" -d \
"{ \"requestCount\": 20, \"seckillCount\": 10, \"seckillId\": 1000}"
====
+
.ä½¿ç”¨Redissonåˆ†å¸ƒå¼é”æ‰§è¡Œï¼Œæ”¯æŒåŠ¨æ€é…ç½®åå°çº¿ç¨‹æ± æ ¸å¿ƒçº¿ç¨‹æ•°ä»¥åŠæœ€å¤§çº¿ç¨‹æ•°
====
[source,bash]
curl --location --request POST 'http://www.goodskill.com:8080/goodskill/web/limit' \
--header 'User-Agent: apifox/1.0.0 (https://www.apifox.cn)' \
--header 'Content-Type: application/json' \
--data-raw '{
    "maxPoolSize": 10,
    "seckillId": 1000,
    "corePoolSize": 2,
    "seckillCount": 100,
    "requestCount": 120
}'
====
+
è¯·æ±‚é»˜è®¤å¼‚æ­¥æ‰§è¡Œï¼Œå¯åœ¨æ§åˆ¶å°æŸ¥çœ‹æ‰§è¡Œæ—¥å¿—ï¼Œå¦‚æœæœ€ç»ˆæˆåŠŸäº¤æ˜“ç¬”æ•°ç­‰äºå•†å“æ•°é‡10åˆ™è¡¨ç¤ºæ²¡æœ‰å‡ºç°è¶…å–æˆ–è€…å°‘å–é—®é¢˜


== ğŸ•¹ï¸ï¸å¯åŠ¨å®Œæ•´é¡¹ç›®æ­¥éª¤
åœ¨å¿«é€Ÿå¼€å§‹éƒ¨åˆ†åŸºç¡€ä¸Šå¢åŠ ä»¥ä¸‹æ­¥éª¤å³å¯å¯åŠ¨ä¸€ä¸ªå®Œæ•´é¡¹ç›®

* è¿›å…¥``goodskill-gateway``æ¨¡å—ï¼Œé€šè¿‡``GatewayApplication``ç±»mainæ–¹æ³•å¯åŠ¨æœåŠ¡ç½‘å…³

* æ‰¾åˆ°``EsApplication``ç±»mainæ–¹æ³•å¯åŠ¨è¿œç¨‹æœåŠ¡

____
é¢å¤–åŠŸèƒ½ï¼ˆå¯é€‰ï¼‰
____

* å·²é›†æˆ``Sentinel``é™æµç»„ä»¶ï¼Œæ”¯æŒ``nacos``é…ç½®ä¸­å¿ƒæ–¹å¼æ¨é€é™æµè§„åˆ™ï¼Œä½¿ç”¨æ—¶éœ€å¯åŠ¨``Sentinel``æ§åˆ¶å°ï¼Œå¹¶ä»¥``18088``ç«¯å£å¯åŠ¨ï¼Œdockerç¯å¢ƒæš‚ä¸æ”¯æŒã€‚

* Seataåˆ†å¸ƒå¼äº‹åŠ¡æµ‹è¯•æ–¹æ³•è§ https://github.com/techa03/goodsKill/tree/master/goodskill-seata/README.md[Seataåˆ†å¸ƒå¼äº‹åŠ¡æµ‹è¯•ç¤ºä¾‹è¿è¡Œè¯´æ˜]

* mainæ–¹æ³•è¿è¡Œ``GoodskillAdminApplication``ç±»(å¾®æœåŠ¡å¥åº·çŠ¶æ€æŒ‡æ ‡ç›‘æ§)

* mainæ–¹æ³•è¿è¡Œ``SwaggerDocsApplication``ç±»(æ¥å£æ–‡æ¡£)

== â“å¸¸è§é—®é¢˜
[qanda]
ä½¿ç”¨ideaå¯åŠ¨``SampleWebJspApplication``ç±»(goodskill-webæ¨¡å—)æ—¶ä¼šå‡ºç°è®¿é—®ä¸äº†é¡µé¢çš„é—®é¢˜ï¼Œeclipseæ— æ­¤é—®é¢˜::

é…ç½®å¯åŠ¨ç±»çš„å·¥ä½œç›®å½•ä¸ºgoodskill-webï¼Œå…·ä½“å¯å‚è€ƒ https://github.com/techa03/goodsKill/issues/108[issue#108]

docker esé•œåƒå¯åŠ¨å¤±è´¥::

å‡ºç°æ­¤é—®é¢˜ä¸€èˆ¬ä¸ºlinuxç¯å¢ƒï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤å³å¯ `sysctl -w vm.max_map_count=262144`
ï¼Œæˆ–è€…ä¿®æ”¹/etc/sysctl.confæ–‡ä»¶ï¼Œè¿½åŠ ä»¥ä¸‹é…ç½®ï¼š
+
[source,text]
----
grep vm.max_map_count /etc/sysctl.conf
vm.max_map_count=262144
----

å¦‚ä½•ä½¿ç”¨æœ¬é¡¹ç›®è‡ªå®šä¹‰çš„OAuth2.0æˆæƒæœåŠ¡å™¨è¿›è¡Œç™»å½•æˆæƒï¼Ÿ::

å¾…å®Œå–„ã€‚ã€‚

é¡¹ç›®é›†æˆçš„å„ä¸ªæ¡†æ¶ä¹‹é—´ç›®å‰çš„å…¼å®¹æ€§å¦‚ä½•ï¼Œå¯ä»¥å‚è€ƒæœ¬é¡¹ç›®çš„é…ç½®åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨å—ï¼Ÿ::

æœ¬é¡¹ç›®ç›®å‰ä¾èµ–çš„å„ä¸ªä¸»æµæ¡†æ¶çš„ç‰ˆæœ¬æ¯”è¾ƒæ–°ï¼Œå°šæœªç»è¿‡å®Œæ•´æµ‹è¯•ï¼Œç›®å‰ä»…ç”¨äºå­¦ä¹ ã€‚å¦‚æœè¦åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ï¼Œå»ºè®®ä½¿ç”¨å®˜æ–¹æ¨èçš„ç¨³å®šç‰ˆæœ¬ã€‚æ¯”å¦‚ç›®å‰çš„Spring Cloud Alibaba Dubboå®˜æ–¹ä¸å»ºè®®ç”Ÿäº§ä¸Šä½¿ç”¨ï¼ŒSpring Cloud Alibabaå®˜æ–¹æ¨èçš„ç¨³å®šç‰ˆä¸º2.2.x{empty}footnote:[é™„ https://start.aliyun.com/bootstrap.html[SpringCloudAlibabaå…¼å®¹ç‰ˆæœ¬è¯´æ˜]]ã€‚

æœåŠ¡å¯åŠ¨æ§åˆ¶å°æŠ¥ERRORæ—¥å¿— ``no available service found in cluster 'default', please make sure registry config correct and keep your seata server running`` å¦‚ä½•è§£å†³ï¼Ÿ::

å¯åŠ¨``seata-server``æœåŠ¡å³å¯ï¼ˆdocker-compose.ymlæ–‡ä»¶ä¸­å·²æä¾›ï¼‰ï¼Œå¯å‚ç…§Seataå®˜ç½‘æ·»åŠ nacosç›¸å…³é…ç½®ã€‚å¦‚æœªä½¿ç”¨åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œå¯å¿½ç•¥è¯¥é”™è¯¯ï¼Œä¸å½±å“æœåŠ¡æ­£å¸¸è¿è¡Œ

== ğŸ“šåˆ†åº“åˆ†è¡¨æƒ…å†µè¯´æ˜

|===
|è¡¨ |æ•°æ®åº“ |æ˜¯å¦åˆ†åº“ |åˆ†åº“å­—æ®µ |æ˜¯å¦åˆ†è¡¨ |åˆ†è¡¨å­—æ®µ

|success_killed |MySQL |æ˜¯ï¼ˆåŒä¸€æœåŠ¡å™¨ä¸­ï¼Œåˆ†ä¸ºseckillå’Œseckill_01ä¸¤ä¸ªåº“ï¼‰ |seckill_id |æ˜¯ï¼ˆåˆ†ä¸ºsuccess_killed_0,success_kill_1ä¸¤å¼ è¡¨ï¼‰ |user_phone
|===

:note-caption: ğŸ“¢
[NOTE]
å…¶ä»–è¡¨å‡æœªåˆ†åº“åˆ†è¡¨ï¼Œé»˜è®¤ä½¿ç”¨seckillä½œä¸ºä¸»åº“

== ğŸ”–æœåŠ¡ç½‘å…³è¯´æ˜
* `http://www.goodskill.com/goodskill/mongo/**` å¯¹åº”è®¿é—®``goodskill-mongo-provider``æœåŠ¡
* `http://www.goodskill.com/goodskill/es/**` å¯¹åº”è®¿é—®``goodskill-es-provider``æœåŠ¡
* `http://www.goodskill.com/goodskill/seata/**` å¯¹åº”è®¿é—®``goodskill-seata``æœåŠ¡
* `http://www.goodskill.com/goodskill/common/**` å¯¹åº”è®¿é—®``goodskill-service-provider``æœåŠ¡
____

åŠ¨æ€è·¯ç”±é…ç½®è¯´æ˜
____
* ç½‘å…³æ”¯æŒåŠ¨æ€åŠ è½½è·¯ç”±é…ç½®ï¼Œä¿®æ”¹åå®æ—¶ç”Ÿæ•ˆï¼Œä½¿ç”¨æ—¶éœ€è¦åœ¨nacosé…ç½®ä¸­å¿ƒæ·»åŠ é…ç½®æ–‡ä»¶ï¼Œæ–‡ä»¶åå¯é€šè¿‡``application.yml``ä¸­çš„``nacos.router.data.id``é…ç½®è¿›è¡Œä¿®æ”¹ï¼ˆé»˜è®¤nacos dataIdä¸º``goodskill-gateway-routes``ï¼‰ï¼Œä¾‹å¦‚ï¼š

+
.è·¯ç”±é…ç½®æ–‡ä»¶å†…å®¹ä¸ºjsonæ•°ç»„æ ¼å¼
====
[source,json]
[
    {
        "id": "goodskill-service-provider",
        "predicates": [
            {
                "name": "Path",
                "args": {
                    "_genkey_0": "/goodskill/common/**"
                }
            }
        ],
        "filters": [
            {
                "name": "StripPrefix",
                "args": {
                    "_genkey_1": "2"
                }
            }
        ],
        "uri": "lb://goodskill-service-provider"
    }
]
====


== ğŸ”¨åç»­æ›´æ–°è®¡åˆ’

|===
|åŠŸèƒ½ |è¿›åº¦ |å®Œæˆæ—¶é—´ |è¯´æ˜
|é›†æˆSpring Cloud Alibabaç»„ä»¶ |âœ… |2020.5 |ç›®å‰å·²é›†æˆnacosã€sentinelã€dubboã€seataç»„ä»¶
|å®Œå–„JWTç”¨æˆ·é‰´æƒï¼Œå¹¶æä¾›é€šç”¨æœåŠ¡æ¥å£ |âœ… |2020.12 |
|é›†æˆåˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆ |âœ… |2021.2 |
|å¢åŠ OAuth2.0æˆæƒç™»å½•æ¨¡å— |âœ… |2021.9 |å¢åŠ è‡ªå®šä¹‰OAuth2.0æˆæƒä»¥åŠèµ„æºæœåŠ¡ï¼Œå¹¶æ”¯æŒç¬¬ä¸‰æ–¹æˆæƒç™»å½•
|é›†æˆELKæ—¥å¿—é‡‡é›† |âœ… |2021.12 |
|ä½¿ç”¨canalæ”¶é›†æ•°æ®åº“å˜æ›´binlogï¼Œç§’æ€ç»“æŸåŠæ—¶é€šçŸ¥ |âœ… |2022.5 |
|JDKç‰ˆæœ¬å‡çº§åˆ°17 |â³ | |
|å°è¯•ä½¿ç”¨COLAé‡æ„éƒ¨åˆ†æ¨¡å— |â³ | |
|å‰åç«¯åˆ†ç¦»ã€é¡µé¢ç¾åŒ– |â³ | | åŸºäºvue-element-adminå¼€å‘
|===

=== APIæ¥å£

image:./doc/shortcut/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20170623222039.png[image]

=== APIæ¥å£è¯´æ˜

image:./doc/shortcut/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20180819224521.png[image]

== ğŸ’»é¡µé¢å±•ç¤º

==== æ™®é€šç”¨æˆ·ç™»å½•

image:./doc/shortcut/img.png[image]

==== æ™®é€šç”¨æˆ·æ³¨å†Œ

image:./doc/shortcut/QQ%E6%B5%8F%E8%A7%88%E5%99%A8%E6%88%AA%E5%9B%BE20180701215804.png[image]

==== ä¸»é¡µ

image:./doc/shortcut/QQ%E6%B5%8F%E8%A7%88%E5%99%A8%E6%88%AA%E5%9B%BE20180701215849.png[image]

==== å•†å“æŸ¥è¯¢

____

æœç´¢æ¡†ä¸‹æ‹‰å•†å“å€™é€‰ä¿¡æ¯åŸºäºelasticsearchå®ç°ï¼Œæ”¯æŒå…³é”®è¯é«˜äº®æ˜¾ç¤º

____

image:doc/shortcut/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20200523214633.png[image]

==== åå°ç®¡ç†ç³»ç»Ÿç™»å½•
image:doc/shortcut/img_2.png[image]

==== åå°ç®¡ç†ç³»ç»Ÿï¼ˆå¼€å‘ä¸­ï¼‰

image:doc/shortcut/img_1.png[image]

==== å•†å“åˆ—è¡¨é™æµ

image:doc/shortcut/å¾®ä¿¡æˆªå›¾_20200802182806.png[image]

==== KafkaçŠ¶æ€ç›‘æ§

image:doc/shortcut/å¾®ä¿¡æˆªå›¾_20210130152701.png[image]

==== æ¨¡æ‹Ÿç§’æ€æ¥å£æµ‹è¯•

image:doc/shortcut/æ¨¡æ‹Ÿç§’æ€æ¥å£æµ‹è¯•.gif[image]

== ğŸ“‘æ•°æ®åº“è¡¨ç»“æ„

image:doc/model_table.png[image]

== ğŸ“–å‚è€ƒæ–‡æ¡£

* è§£å†³Dockerå®¹å™¨è¿æ¥ Kafka è¿æ¥å¤±è´¥é—®é¢˜ï¼š`https://www.cnblogs.com/hellxz/p/why_cnnect_to_kafka_always_failure.html`
